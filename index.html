<!DOCTYPE html>
<html lang="ms-MY">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kemahiran Pemulihan: Masa & Waktu (Intermediate)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        /* --- UI STYLE (TEMA HIJAU KONSISTEN) --- */
        body {
            font-family: 'Fredoka', sans-serif;
            background-color: #f0fdf4;
            background-image: radial-gradient(#86efac 2px, transparent 2px);
            background-size: 30px 30px;
        }

        /* Card Container */
        .game-card {
            background: white;
            border: 4px solid #475569;
            box-shadow: 8px 8px 0px #00000020;
            border-radius: 1.5rem;
            transition: transform 0.2s;
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Buttons 3D */
        .btn-3d {
            transition: all 0.1s;
            border-bottom-width: 6px;
            border-color: rgba(0, 0, 0, 0.2);
            transform: translateY(0);
            cursor: pointer;
            display: inline-block;
        }

        .btn-3d:active:not(:disabled) {
            transform: translateY(4px);
            border-bottom-width: 2px;
            box-shadow: none;
        }

        .btn-3d:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            border-bottom-width: 6px;
            filter: grayscale(100%);
        }

        /* Animation */
        .shake {
            animation: shake 0.4s ease-in-out;
            border-color: #ef4444 !important;
            background-color: #fee2e2 !important;
        }

        @keyframes shake {

            0%,
            100% {
                transform: translateX(0);
            }

            25% {
                transform: translateX(-8px) rotate(-5deg);
            }

            75% {
                transform: translateX(8px) rotate(5deg);
            }
        }

        .drag-item {
            cursor: grab;
            user-select: none;
            transition: transform 0.1s;
        }

        .drag-item:active {
            cursor: grabbing;
            transform: scale(0.95);
        }

        /* --- STYLES KHUSUS JAM (SVG) --- */
        .clock-container {
            max-width: 220px;
            margin: 0 auto;
            touch-action: none;
        }

        .clock-face {
            stroke: #334155;
            stroke-width: 8;
            fill: #f8fafc;
        }

        .clock-center {
            fill: #334155;
        }

        .clock-hand {
            stroke-linecap: round;
            transform-origin: 50% 50%;
            /* PENTING: Putar dari tengah */
            transition: transform 0.1s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .clock-hand-hour {
            stroke: #3b82f6;
            stroke-width: 8;
        }

        /* Biru */
        .clock-hand-minute {
            stroke: #16a34a;
            stroke-width: 6;
        }

        /* Hijau */
        .clock-hand-second {
            stroke: #ef4444;
            stroke-width: 3;
        }

        /* Merah (jika perlu) */

        /* Jadual Harian Styles */
        .jadual-item {
            border-left: 6px solid #8b5cf6;
            background-color: #f3f4f6;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 8px;
        }
    </style>
</head>
</head>

<body class="h-screen w-screen overflow-hidden text-slate-800 flex flex-col overscroll-none">

    <div class="fixed top-2 left-0 right-0 z-50 px-4 pointer-events-none">
        <div
            class="max-w-4xl mx-auto bg-green-400 border-4 border-green-600 rounded-full px-4 py-1.5 shadow-xl flex items-center justify-between pointer-events-auto transform hover:scale-[1.01] transition-transform">
            <div class="flex items-center gap-2">
                <span class="text-2xl animate-bounce">‚è∞</span>
                <span id="info-text" class="text-base font-bold text-green-900 leading-none mt-0.5">Masa & Waktu
                    (Sederhana)</span>
            </div>
            <button id="speak-btn" onclick="speakInfo()"
                class="bg-white hover:bg-green-50 text-green-600 border-2 border-green-200 rounded-full p-1 transition-colors shadow-sm text-sm">üîä</button>
        </div>
    </div>
    <div class="h-16 flex-none"></div>

    <div class="max-w-6xl mx-auto p-2 w-full flex-1 flex flex-col overflow-hidden min-h-0">

        <div class="game-card p-4 mb-2 flex items-center justify-center relative w-full">
            <div id="activity-content" class="w-full h-full relative z-10 flex flex-col">
                <div class="py-4 text-center">
                    <div class="text-6xl mb-2 animate-pulse">‚è≥</div>
                    <h2 class="text-3xl font-bold text-emerald-600 mb-2">Masa & Waktu</h2>
                    <p class="text-lg text-slate-500 mb-4 font-semibold">Kira Tempoh, Jadual & Lumba Minit</p>
                    <div class="text-2xl animate-bounce">üëá</div>
                </div>
            </div>
        </div>

        <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg p-2 border-2 border-white flex-none">
            <h3 class="text-sm font-bold text-slate-700 mb-2 text-center uppercase tracking-wider">üéÆ Pilih Aktiviti
            </h3>

            <div class="flex flex-wrap justify-center gap-2 mb-2">
                <button onclick="loadActivity(1)"
                    class="btn-3d bg-blue-500 text-white font-bold py-2 px-3 rounded-lg text-xs">üï∞Ô∏è Mesin Masa</button>
                <button onclick="loadActivity(2)"
                    class="btn-3d bg-emerald-500 text-white font-bold py-2 px-3 rounded-lg text-xs">‚è±Ô∏è Kira
                    Tempoh</button>
                <button onclick="loadActivity(3)"
                    class="btn-3d bg-violet-500 text-white font-bold py-2 px-3 rounded-lg text-xs">üìù Jadual
                    Saya</button>
                <button onclick="loadActivity(4)"
                    class="btn-3d bg-red-500 text-white font-bold py-2 px-3 rounded-lg text-xs">‚è≥ Baki Masa</button>
                <button onclick="loadActivity(5)"
                    class="btn-3d bg-orange-500 text-white font-bold py-2 px-3 rounded-lg text-xs">üèÅ Lumba
                    Minit</button>
            </div>

            <div class="flex justify-center gap-2 border-t-2 border-slate-100 pt-2">
                <button onclick="clearActivity()"
                    class="btn-3d bg-slate-400 text-white font-bold py-1 px-4 rounded-full text-xs">üè† Menu</button>
                <button onclick="nextActivity()"
                    class="btn-3d bg-indigo-500 text-white font-bold py-1 px-6 rounded-full text-sm">Seterusnya
                    ‚û°Ô∏è</button>
            </div>
        </div>
    </div>

    <script>
        /* --- STANDARD HELPERS --- */
        let currentActivity = 0;
        let ttsEnabled = false;
        let currentInfo = "Pilih aktiviti untuk mula.";

        // State Variables
        let clockState = { hour: 3, minute: 0, isDragging: null };
        let activityTimer = null;
        let activityState = {};

        function triggerWin() { confetti({ particleCount: 150, spread: 80, origin: { y: 0.6 } }); }

        function speak(text) {
            if (!ttsEnabled || !('speechSynthesis' in window)) return;
            window.speechSynthesis.cancel();
            const u = new SpeechSynthesisUtterance(text);
            u.lang = 'ms-MY'; u.rate = 0.9; u.pitch = 1.1;
            const voices = window.speechSynthesis.getVoices();
            const ms = voices.find(v => v.lang === 'ms-MY' || v.lang?.startsWith('ms'));
            if (ms) u.voice = ms;
            window.speechSynthesis.speak(u);
        }

        function setInfo(text) {
            currentInfo = text;
            const infoEl = document.getElementById('info-text');
            infoEl.style.opacity = 0;
            setTimeout(() => { infoEl.textContent = text; infoEl.style.opacity = 1; }, 200);
        }

        function speakInfo() {
            if (!ttsEnabled) {
                ttsEnabled = true;
                document.getElementById('speak-btn').classList.add('bg-green-100', 'text-green-600');
            }
            speak(currentInfo);
        }

        /* --- JAM ANALOG GENERATOR & LOGIC --- */
        function createClockSVG(container, initialHour, initialMinute, isStatic = false) {
            const clockId = `clock-${Math.random().toString(36).substr(2, 9)}`;
            container.innerHTML = `
        <svg viewBox="0 0 200 200" class="clock-container" id="${clockId}">
          <circle cx="100" cy="100" r="95" class="clock-face"/>
          ${Array.from({ length: 12 }).map((_, i) => {
                const angle = (i + 1) * 30 * Math.PI / 180;
                const x = 100 + Math.sin(angle) * 78; const y = 100 - Math.cos(angle) * 78;
                return `<text x="${x}" y="${y + 5}" text-anchor="middle" font-size="16" font-weight="bold" fill="#334155" style="font-family: 'Fredoka'">${i + 1}</text>`;
            }).join('')}
          ${Array.from({ length: 60 }).map((_, i) => {
                const angle = i * 6 * Math.PI / 180;
                const x1 = 100 + Math.sin(angle) * (i % 5 === 0 ? 85 : 90);
                const y1 = 100 - Math.cos(angle) * (i % 5 === 0 ? 85 : 90);
                const x2 = 100 + Math.sin(angle) * 92; const y2 = 100 - Math.cos(angle) * 92;
                return `<line x1="${x1}" y1="${y1}" x2="${x2}" y2="${y2}" style="stroke:${i % 5 === 0 ? '#334155' : '#cbd5e1'}; stroke-width: ${i % 5 === 0 ? 3 : 1};" />`;
            }).join('')}
          
          <line id="hand-hour-${clockId}" x1="100" y1="100" x2="100" y2="55" class="clock-hand clock-hand-hour"/>
          <line id="hand-minute-${clockId}" x1="100" y1="100" x2="100" y2="30" class="clock-hand clock-hand-minute"/>
          <circle cx="100" cy="100" r="6" class="clock-center"/>
        </svg>
      `;
            updateClockHands(clockId, initialHour, initialMinute);

            if (!isStatic) {
                const clockEl = document.getElementById(clockId);
                clockEl.style.cursor = 'pointer';
                clockState = { hour: initialHour, minute: initialMinute, isDragging: null, id: clockId };

                clockEl.addEventListener('mousedown', startClockDrag);
                clockEl.addEventListener('touchstart', startClockDrag, { passive: false });
            }
            return clockId;
        }

        function updateClockHands(clockId, hour, minute) {
            const hourEl = document.getElementById(`hand-hour-${clockId}`);
            const minuteEl = document.getElementById(`hand-minute-${clockId}`);
            if (!hourEl || !minuteEl) return;
            const minuteDeg = minute * 6;
            const hourDeg = (hour % 12) * 30 + (minute * 0.5);
            hourEl.style.transform = `rotate(${hourDeg}deg)`;
            minuteEl.style.transform = `rotate(${minuteDeg}deg)`;
        }

        function startClockDrag(e) {
            e.preventDefault();
            const clockEl = e.currentTarget;
            const bb = clockEl.getBoundingClientRect();
            const cx = bb.left + bb.width / 2; const cy = bb.top + bb.height / 2;
            const px = e.clientX || e.touches[0].clientX; const py = e.clientY || e.touches[0].clientY;
            const dx = px - cx; const dy = py - cy;
            const dist = Math.sqrt(dx * dx + dy * dy);

            if (dist < bb.width * 0.35) { clockState.isDragging = 'hour'; }
            else if (dist < bb.width * 0.5) { clockState.isDragging = 'minute'; }

            if (clockState.isDragging) {
                window.addEventListener('mousemove', handleClockDrag);
                window.addEventListener('touchmove', handleClockDrag, { passive: false });
                window.addEventListener('mouseup', stopClockDrag);
                window.addEventListener('touchend', stopClockDrag);
            }
        }

        function handleClockDrag(e) {
            if (!clockState.isDragging) return;
            e.preventDefault();
            const clockEl = document.getElementById(clockState.id);
            if (!clockEl) return;

            const bb = clockEl.getBoundingClientRect();
            const cx = bb.width / 2; const cy = bb.height / 2;
            const px = (e.clientX || e.touches[0].clientX) - bb.left;
            const py = (e.clientY || e.touches[0].clientY) - bb.top;

            let angleRad = Math.atan2(py - cy, px - cx) + Math.PI / 2;
            let angleDeg = angleRad * 180 / Math.PI;
            if (angleDeg < 0) angleDeg += 360;

            if (clockState.isDragging === 'minute') {
                clockState.minute = Math.round(angleDeg / 6) % 60;
            } else {
                const hour = Math.round(angleDeg / 30) % 12;
                clockState.hour = (clockState.hour >= 12 ? 12 : 0) + hour;
            }

            updateClockHands(clockState.id, clockState.hour, clockState.minute);
            if (currentActivity === 1) updateMesinMasaDisplay(clockState.hour, clockState.minute);
        }

        function stopClockDrag(e) {
            if (clockState.isDragging) {
                clockState.isDragging = null;
                window.removeEventListener('mousemove', handleClockDrag);
                window.removeEventListener('touchmove', handleClockDrag);
                window.removeEventListener('mouseup', stopClockDrag);
                window.removeEventListener('touchend', stopClockDrag);
                const msg = `Jam pukul ${clockState.hour}:${clockState.minute.toString().padStart(2, '0')}`;
                speak(msg);
            }
        }

        /* --- ROUTER --- */
        function loadActivity(n) {
            currentActivity = n;
            const content = document.getElementById('activity-content');
            content.style.opacity = 0;

            // Cleanup
            stopClockDrag();
            if (activityTimer) clearInterval(activityTimer);

            setTimeout(() => {
                if (n === 1) loadMesinMasa(content);
                if (n === 2) loadKiraTempoh(content);
                if (n === 3) loadJadualHarian(content);
                if (n === 4) loadBakiMasa(content);
                if (n === 5) loadLumbaMinit(content);
                content.style.opacity = 1;
            }, 200);
        }

        function clearActivity() {
            currentActivity = 0;
            if (activityTimer) clearInterval(activityTimer);
            document.getElementById('activity-content').innerHTML = `<div class="h-full flex flex-col justify-center items-center py-4 text-center"><div class="text-6xl mb-4 animate-bounce">‚è≥</div><h2 class="text-3xl font-bold text-emerald-600 mb-2">Masa & Waktu</h2><p class="text-lg text-slate-500 font-semibold">Pilih butang di bawah.</p></div>`;
            setInfo("Pilih aktiviti untuk mula.");
        }
        function nextActivity() { let next = currentActivity + 1; if (next > 5) next = 1; loadActivity(next); }

        /* =========================================
           LOGIK AKTIVITI
           ========================================= */

        /* --- 1. MESIN MASA --- */
        function loadMesinMasa(content) {
            setInfo("Mula 2:00. Tempoh 3 jam 15 minit. Laraskan Jam Tamat.");
            content.innerHTML = `
            <h3 class="text-xl font-bold text-blue-500 mb-2 text-center flex-none">üï∞Ô∏è Mesin Masa (Laraskan Jam)</h3>
            <div class="flex-1 overflow-hidden p-2 flex flex-col items-center justify-center">
                <div class="bg-blue-50 rounded-2xl p-4 border-2 border-blue-200 text-center w-full max-w-3xl">
                    <p class="text-sm text-slate-600 mb-2 font-bold">Mula: 2:00 | Tempoh: <span class="text-blue-600">3 jam 15 minit</span></p>
                    
                    <div class="flex flex-col md:flex-row justify-center items-center gap-4 mb-4">
                        <div class="bg-white p-2 rounded-xl shadow-sm">
                            <div class="text-xs font-bold text-slate-400 mb-1">Masa Mula</div>
                            <div id="clock-start" class="scale-90"></div>
                        </div>
                        <div class="text-2xl text-slate-300">‚û°Ô∏è</div>
                        <div class="bg-white p-2 rounded-xl shadow-sm border-2 border-blue-300">
                            <div class="text-xs font-bold text-blue-500 mb-1">Jam Tamat (Gerakkan Jarum)</div>
                            <div id="clock-end" class="scale-90"></div>
                            <div id="digital-display-1" class="text-xl font-black text-slate-700 mt-1 bg-slate-100 rounded px-2">03:00</div>
                        </div>
                    </div>
    
                    <button id="semak-1" class="btn-3d bg-blue-500 text-white font-bold py-2 px-6 rounded-lg text-sm">Semak Jawapan</button>
                </div>
            </div>
        `;
            createClockSVG(document.getElementById('clock-start'), 2, 0, true);
            createClockSVG(document.getElementById('clock-end'), 3, 0, false);
            updateMesinMasaDisplay(3, 0);

            document.getElementById('semak-1').onclick = () => {
                const isCorrect = (clockState.hour % 12 === 5) && (clockState.minute === 15);
                if (isCorrect) {
                    setInfo("Tahniah! 5:15 ialah jawapan yang betul.");
                    triggerWin();
                    speak("Betul! 5 15.");
                } else {
                    setInfo("Salah. 2 tambah 3 jadi 5. Cuba lagi.");
                    speak("Salah. Cuba lagi.");
                    document.getElementById('clock-end').classList.add('shake');
                    setTimeout(() => document.getElementById('clock-end').classList.remove('shake'), 500);
                }
            };
        }
        function updateMesinMasaDisplay(h, m) {
            const hh = h % 12 === 0 ? 12 : h % 12;
            document.getElementById('digital-display-1').textContent = `${hh.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}`;
        }

        /* --- 2. KIRA TEMPOH --- */
        function loadKiraTempoh(content) {
            setInfo("Berapa jam dari 9:00 pagi hingga 1:00 petang?");
            activityState = { duration: 0 };

            content.innerHTML = `
            <h3 class="text-xl font-bold text-emerald-500 mb-2 text-center flex-none">‚è±Ô∏è Kira Tempoh</h3>
            <div class="flex-1 overflow-hidden p-2 flex flex-col items-center justify-center">
                <div class="bg-emerald-50 rounded-2xl p-4 border-2 border-emerald-200 w-full max-w-3xl text-center">
                    <p class="text-sm font-bold text-slate-600 mb-4">Dari 9:00 Pagi hingga 1:00 Petang</p>
                    
                    <div class="flex justify-center gap-4 mb-4">
                        <div id="clock-start-2" class="scale-75 origin-top"></div>
                        <div id="clock-end-2" class="scale-75 origin-top"></div>
                    </div>
    
                    <div class="bg-white p-2 rounded-lg inline-block shadow-sm border border-emerald-100 mb-4">
                        <div class="text-xs text-slate-400 font-bold uppercase">Tempoh Dikira</div>
                        <div id="tempoh-display" class="text-3xl font-black text-emerald-600 my-1">0 jam</div>
                        <div class="flex gap-2 justify-center">
                            <button id="tolak-jam" class="bg-slate-200 text-slate-600 px-3 py-1 rounded text-sm font-bold hover:bg-slate-300">-</button>
                            <button id="tambah-jam" class="bg-emerald-500 text-white px-3 py-1 rounded text-sm font-bold hover:bg-emerald-600">+</button>
                        </div>
                    </div>
                    <br>
                    <button id="semak-2" class="btn-3d bg-emerald-600 text-white font-bold py-2 px-6 rounded-lg text-sm">Semak</button>
                </div>
            </div>
        `;
            createClockSVG(document.getElementById('clock-start-2'), 9, 0, true);
            createClockSVG(document.getElementById('clock-end-2'), 13, 0, true);

            const display = document.getElementById('tempoh-display');
            document.getElementById('tambah-jam').onclick = () => { activityState.duration++; display.textContent = activityState.duration + " jam"; };
            document.getElementById('tolak-jam').onclick = () => { if (activityState.duration > 0) activityState.duration--; display.textContent = activityState.duration + " jam"; };

            document.getElementById('semak-2').onclick = () => {
                if (activityState.duration === 4) {
                    setInfo("Tepat! 4 jam."); triggerWin(); speak("Betul, 4 jam.");
                } else {
                    setInfo("Salah. Kira: 9 ke 10, 10 ke 11..."); speak("Salah.");
                    display.classList.add('shake'); setTimeout(() => display.classList.remove('shake'), 500);
                }
            };
        }

        /* --- 3. JADUAL HARIAN --- */
        function loadJadualHarian(content) {
            setInfo("Bina jadual anda. Klik butang aktiviti.");
            activityState = { currentTimeMinutes: 8 * 60 };

            content.innerHTML = `
            <h3 class="text-xl font-bold text-violet-500 mb-2 text-center flex-none">üìù Jadual Harian Saya</h3>
            <div class="flex-1 overflow-hidden p-2 flex flex-col items-center w-full">
                <div class="flex flex-col md:flex-row gap-4 h-full w-full max-w-4xl">
                    <div class="bg-violet-50 p-2 rounded-xl border-2 border-violet-200 md:w-1/3 flex flex-col">
                        <h4 class="font-bold text-violet-800 mb-2 text-center text-xs">Pilih Aktiviti</h4>
                        <div id="bank-butang" class="flex flex-col gap-2 overflow-y-auto">
                            <button data-name="Matematik" data-duration="60" class="btn-3d bg-white border-violet-200 text-violet-700 font-bold py-2 px-3 rounded-lg text-left text-xs">üìê Matematik (1j)</button>
                            <button data-name="Rehat" data-duration="30" class="btn-3d bg-white border-violet-200 text-violet-700 font-bold py-2 px-3 rounded-lg text-left text-xs">ü•™ Rehat (30m)</button>
                            <button data-name="Sains" data-duration="90" class="btn-3d bg-white border-violet-200 text-violet-700 font-bold py-2 px-3 rounded-lg text-left text-xs">üß™ Sains (1j 30m)</button>
                            <button data-name="Sukan" data-duration="45" class="btn-3d bg-white border-violet-200 text-violet-700 font-bold py-2 px-3 rounded-lg text-left text-xs">‚öΩ Sukan (45m)</button>
                        </div>
                    </div>
                    <div class="md:w-2/3 bg-white p-2 rounded-xl border-2 border-slate-200 flex flex-col overflow-hidden">
                        <h4 class="font-bold text-slate-500 mb-2 text-xs">Jadual (Mula 8:00 AM)</h4>
                        <div id="jadual-list" class="flex-grow overflow-y-auto pr-1">
                            <div class="text-slate-300 text-center italic mt-4 text-xs">Jadual kosong...</div>
                        </div>
                    </div>
                </div>
            </div>
        `;

            document.getElementById('bank-butang').querySelectorAll('button').forEach(btn => {
                btn.onclick = (e) => {
                    const name = e.target.dataset.name;
                    const duration = parseInt(e.target.dataset.duration);
                    const start = activityState.currentTimeMinutes;
                    const end = start + duration;

                    const newItem = document.createElement('div');
                    newItem.className = "jadual-item animate-[popIn_0.3s]";
                    newItem.innerHTML = `
                    <div class="flex justify-between items-center">
                        <span class="font-bold text-slate-700">${name}</span>
                        <span class="bg-violet-100 text-violet-700 px-2 py-1 rounded text-xs font-bold">${formatTime(start)} ‚ûî ${formatTime(end)}</span>
                    </div>
                `;

                    const list = document.getElementById('jadual-list');
                    if (list.querySelector('.text-slate-300')) list.innerHTML = '';
                    list.appendChild(newItem);
                    list.scrollTop = list.scrollHeight;

                    activityState.currentTimeMinutes = end;
                    speak(`Tambah ${name}`);
                }
            });
        }
        function formatTime(mins) {
            let h = Math.floor(mins / 60) % 24;
            let m = mins % 60;
            let ampm = h >= 12 ? 'PM' : 'AM';
            h = h % 12 || 12;
            return `${h}:${m.toString().padStart(2, '0')} ${ampm}`;
        }

        /* --- 4. BAKI MASA (GAME) --- */
        function loadBakiMasa(content) {
            activityState = { baki: 20 };
            setInfo("Anda ada 20 minit rehat. Pilih aktiviti!");

            content.innerHTML = `
            <h3 class="text-xl font-bold text-red-500 mb-2 text-center flex-none">‚è≥ Baki Masa Rehat</h3>
            <div class="flex-1 overflow-y-auto px-4 w-full flex flex-col items-center">
                <div class="max-w-2xl mx-auto bg-red-50 rounded-full py-2 px-6 border-2 border-red-200 text-center mb-4 w-fit flex-none">
                    <span class="text-red-800 font-bold uppercase text-xs mr-2">Baki Masa</span>
                    <span id="baki-display" class="text-3xl font-black text-red-600">20</span>
                    <span class="text-red-800 font-bold text-xs ml-1">minit</span>
                </div>
    
                <div id="options-grid" class="grid grid-cols-2 gap-2 max-w-xl mx-auto w-full flex-none"></div>
                <div class="text-center mt-4 flex-none"><button onclick="loadActivity(4)" class="text-slate-400 underline font-bold text-xs">Reset</button></div>
            </div>
        `;
            renderOptions();
        }
        function renderOptions() {
            const container = document.getElementById('options-grid');
            const items = [
                { name: "Makan", cost: 10, icon: "üçú" }, { name: "Beli Air", cost: 5, icon: "ü•§" },
                { name: "Tandas", cost: 5, icon: "üöΩ" }, { name: "Main Bola", cost: 15, icon: "‚öΩ" }
            ];

            container.innerHTML = "";
            if (activityState.baki === 0) {
                container.innerHTML = `<div class="col-span-2 text-center font-bold text-2xl text-red-600 animate-pulse">KRINGGG! Masa Tamat!</div>`;
                return;
            }

            items.forEach(item => {
                const disabled = activityState.baki < item.cost;
                container.innerHTML += `
                <button onclick="useTime(${item.cost})" ${disabled ? 'disabled' : ''} 
                    class="btn-3d bg-white border-red-200 text-slate-700 p-4 rounded-xl flex items-center justify-between ${disabled ? 'opacity-50 grayscale' : ''}">
                    <span class="text-2xl mr-2">${item.icon}</span>
                    <span class="font-bold">${item.name}</span>
                    <span class="bg-red-100 text-red-700 px-2 py-1 rounded text-xs font-bold">-${item.cost}m</span>
                </button>
            `;
            });
        }
        window.useTime = function (cost) {
            activityState.baki -= cost;
            document.getElementById('baki-display').textContent = activityState.baki;
            renderOptions();
            speak(`Tolak ${cost} minit.`);
        }

        /* --- 5. LUMBA MINIT --- */
        function loadLumbaMinit(content) {
            const target = 15;
            setInfo(`Tekan & Tahan butang. Lepaskan bila jarum sampai minit ${target}!`);

            content.innerHTML = `
            <h3 class="text-xl font-bold text-orange-500 mb-2 text-center flex-none">üèÅ Lumba Minit (Refleks)</h3>
            <div class="flex-1 overflow-hidden p-2 flex flex-col items-center justify-center">
                <div class="text-center mb-2 font-bold text-slate-500 text-xs">Sasaran: <span class="text-orange-600 text-lg">${target} Minit</span></div>
                
                <div id="game-clock" class="mb-2 scale-90"></div>
                <div id="game-res" class="text-center text-xl font-black text-slate-800 mb-4 h-8">0 Minit</div>
                
                <div class="text-center">
                    <button id="hold-btn" class="btn-3d bg-orange-500 text-white font-bold py-3 px-8 rounded-full text-lg shadow-lg active:bg-orange-600">
                        TEKAN & TAHAN ‚úä
                    </button>
                </div>
            </div>
        `;

            const clockId = createClockSVG(document.getElementById('game-clock'), 0, 0, true);
            let min = 0;
            const btn = document.getElementById('hold-btn');
            const res = document.getElementById('game-res');

            const run = () => {
                min = (min + 1) % 60;
                updateClockHands(clockId, 0, min);
                res.textContent = `${min} Minit`;
            };

            btn.onmousedown = (e) => {
                e.preventDefault(); min = 0; activityTimer = setInterval(run, 40); // Laju
                btn.classList.add('scale-95');
            };
            btn.onmouseup = (e) => {
                e.preventDefault(); clearInterval(activityTimer);
                btn.classList.remove('scale-95');
                if (min === target) {
                    res.className = "text-center text-4xl font-black text-green-500 animate-bounce";
                    res.textContent = "TEPAT! üéâ"; triggerWin(); speak("Hebat! Tepat sekali.");
                } else {
                    res.className = "text-center text-3xl font-black text-red-500";
                    res.textContent = `Tersasar! (${min} minit)`; speak("Tersasar.");
                }
            };
            btn.ontouchstart = btn.onmousedown;
            btn.ontouchend = btn.onmouseup;
        }

        if ('speechSynthesis' in window) { setInterval(() => { if (window.speechSynthesis.paused) window.speechSynthesis.resume(); }, 1000); }
    </script>
</body>

</html>